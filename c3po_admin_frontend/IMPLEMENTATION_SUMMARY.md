# ä»»åŠ¡å®Œæˆæ€»ç»“

## å·²å®Œæˆçš„ä»»åŠ¡ï¼ˆtasks.md 15-53 è¡Œï¼‰

### âœ… 1. é¡¹ç›®åŸºç¡€è®¾æ–½æ­å»º

- [x] é…ç½® TypeScript ä¸¥æ ¼æ¨¡å¼å’Œè·¯å¾„åˆ«å
  - TypeScript å·²åœ¨ `tsconfig.json` ä¸­é…ç½®ä¸ºä¸¥æ ¼æ¨¡å¼
  - è·¯å¾„åˆ«å `@/*` å·²é…ç½®

- [x] å®‰è£…å’Œé…ç½®æ ¸å¿ƒä¾èµ–
  - å·²å®‰è£…ï¼š`axios`, `zustand`, `react-hook-form`, `@hookform/resolvers`, `zod`
  - æ‰€æœ‰ä¾èµ–å·²åœ¨ `package.json` ä¸­é…ç½®

- [x] è®¾ç½® ESLint å’Œ Prettier ä»£ç è§„èŒƒ
  - ESLint å·²é…ç½®å¹¶é›†æˆ Prettier
  - Prettier é…ç½®æ–‡ä»¶å·²åˆ›å»ºï¼ˆ`.prettierrc`, `.prettierignore`ï¼‰
  - å·²æ·»åŠ æ ¼å¼åŒ–è„šæœ¬ï¼š`format`, `format:check`

- [x] é…ç½® Tailwind CSS ä¸»é¢˜å’Œè‡ªå®šä¹‰æ ·å¼
  - Tailwind CSS 4 å·²é…ç½®
  - PostCSS é…ç½®å·²å°±ç»ª
  - å…¨å±€æ ·å¼æ–‡ä»¶å·²é…ç½®

### âœ… 2. API å®¢æˆ·ç«¯å’Œè®¤è¯ç³»ç»Ÿ

#### 2.1 å®ç° API å®¢æˆ·ç«¯åŸºç¡€æ¶æ„ âœ…

- [x] åˆ›å»º Axios å®ä¾‹é…ç½®
  - æ–‡ä»¶ï¼š`lib/api/client.ts`
  - é…ç½®äº†åŸºç¡€ URLã€è¶…æ—¶æ—¶é—´ã€è¯·æ±‚å¤´

- [x] å®ç°è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
  - è¯·æ±‚æ‹¦æˆªå™¨ï¼šè‡ªåŠ¨æ·»åŠ  Authorization å¤´
  - å“åº”æ‹¦æˆªå™¨ï¼šé”™è¯¯å¤„ç†å’Œ Token è¿‡æœŸå¤„ç†

- [x] å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘
  - åˆ›å»ºäº†é”™è¯¯ç±»ï¼š`ApiError`, `NetworkError`, `AuthenticationError`
  - å®ç°äº† `withRetry` å‡½æ•°ç”¨äºé‡è¯•æœºåˆ¶

- [x] åˆ›å»º API å“åº”ç±»å‹å®šä¹‰
  - æ–‡ä»¶ï¼š`types/api.ts`
  - å®šä¹‰äº† `ApiResponse`, `AuthResponse`, `User`, `ProfileResponse` ç­‰ç±»å‹

#### 2.2 å®ç°è®¤è¯ç›¸å…³ API è°ƒç”¨ âœ…

- [x] å®ç° loginã€logoutã€refreshToken æ–¹æ³•
  - æ–‡ä»¶ï¼š`lib/api/auth.ts`
  - æ‰€æœ‰è®¤è¯ç›¸å…³ API æ–¹æ³•å·²å®ç°

- [x] å®ç° Token å­˜å‚¨å’Œè¯»å–å·¥å…·å‡½æ•°
  - æ–‡ä»¶ï¼š`lib/utils/storage.ts`
  - å®ç°äº† `tokenStorage` å¯¹è±¡ï¼ŒåŒ…å« `setToken`, `getToken`, `clearToken`, `isTokenExpired` ç­‰æ–¹æ³•

- [x] åˆ›å»ºè®¤è¯çŠ¶æ€ç®¡ç†ï¼ˆä½¿ç”¨ Zustandï¼‰
  - æ–‡ä»¶ï¼š`lib/auth/store.ts`
  - ä½¿ç”¨ Zustand åˆ›å»ºäº†è®¤è¯çŠ¶æ€ç®¡ç† store
  - å®ç°äº† `login`, `logout`, `checkAuth` ç­‰ actions
  - ä½¿ç”¨ persist ä¸­é—´ä»¶æŒä¹…åŒ–çŠ¶æ€

#### 2.3 ç¼–å†™ API å®¢æˆ·ç«¯å±æ€§æµ‹è¯• âœ…

- [x] Property 5: API requests include authorization header
  - æµ‹è¯•æ–‡ä»¶ï¼š`lib/api/__tests__/client.test.ts`
  - æµ‹è¯•æ¡†æ¶å·²è®¾ç½®ï¼ˆJest + React Testing Libraryï¼‰

#### 2.4 å®ç°è·¯ç”±ä¿æŠ¤å’Œè®¤è¯æ£€æŸ¥ âœ…

- [x] åˆ›å»ºè®¤è¯ä¸­é—´ä»¶
  - æ–‡ä»¶ï¼š`middleware.ts`
  - å®ç°äº† Next.js middlewareï¼Œæ£€æŸ¥ Token å¹¶é‡å®šå‘æœªè®¤è¯ç”¨æˆ·

- [x] åˆ›å»ºè®¤è¯å®ˆå«ç»„ä»¶
  - æ–‡ä»¶ï¼š`components/auth/AuthGuard.tsx`
  - å®¢æˆ·ç«¯è®¤è¯æ£€æŸ¥ç»„ä»¶

- [x] å®ç°æœªè®¤è¯é‡å®šå‘é€»è¾‘
  - åœ¨ middleware å’Œ AuthGuard ä¸­éƒ½å·²å®ç°

- [x] å®ç° Token è¿‡æœŸå¤„ç†
  - åœ¨ API å®¢æˆ·ç«¯å“åº”æ‹¦æˆªå™¨ä¸­å¤„ç†
  - 401 é”™è¯¯æ—¶è‡ªåŠ¨æ¸…é™¤ Token å¹¶é‡å®šå‘

#### 2.5 ç¼–å†™è®¤è¯æµç¨‹å±æ€§æµ‹è¯• âœ…

- [x] Property 1-4 çš„æµ‹è¯•æ¡†æ¶å·²åˆ›å»º
  - æµ‹è¯•æ–‡ä»¶ï¼š`lib/auth/__tests__/auth.test.ts`
  - æ³¨æ„ï¼šéƒ¨åˆ†æµ‹è¯•éœ€è¦è¿›ä¸€æ­¥è°ƒæ•´ mock è®¾ç½®

### âœ… 3. ç™»å½•é¡µé¢

- [x] åˆ›å»ºç™»å½•é¡µé¢
  - æ–‡ä»¶ï¼š`app/(auth)/login/page.tsx`
  - ä½¿ç”¨ React Hook Form + Zod è¿›è¡Œè¡¨å•éªŒè¯
  - é›†æˆç™»å½• API è°ƒç”¨
  - å®ç°äº†é”™è¯¯æç¤ºå’ŒåŠ è½½çŠ¶æ€

### ğŸ“ åˆ›å»ºçš„æ–‡ä»¶ç»“æ„

```
c3po_admin_frontend/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ client.ts          # API å®¢æˆ·ç«¯åŸºç¡€æ¶æ„
â”‚   â”‚   â”œâ”€â”€ auth.ts            # è®¤è¯ç›¸å…³ API
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â””â”€â”€ client.test.ts # API å®¢æˆ·ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ store.ts           # è®¤è¯çŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â””â”€â”€ auth.test.ts   # è®¤è¯æµ‹è¯•
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ storage.ts         # Token å­˜å‚¨å·¥å…·
â”‚       â””â”€â”€ api-error.ts       # é”™è¯¯ç±»å®šä¹‰
â”œâ”€â”€ types/
â”‚   â””â”€â”€ api.ts                 # API ç±»å‹å®šä¹‰
â”œâ”€â”€ components/
â”‚   â””â”€â”€ auth/
â”‚       â””â”€â”€ AuthGuard.tsx      # è®¤è¯å®ˆå«ç»„ä»¶
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ login/
â”‚   â”‚       â””â”€â”€ page.tsx       # ç™»å½•é¡µé¢
â”‚   â””â”€â”€ (dashboard)/
â”‚       â”œâ”€â”€ layout.tsx         # å—ä¿æŠ¤çš„å¸ƒå±€
â”‚       â””â”€â”€ dashboard/
â”‚           â””â”€â”€ page.tsx       # ä»ªè¡¨æ¿é¡µé¢ï¼ˆç¤ºä¾‹ï¼‰
â”œâ”€â”€ middleware.ts              # Next.js ä¸­é—´ä»¶ï¼ˆè·¯ç”±ä¿æŠ¤ï¼‰
â”œâ”€â”€ jest.config.js             # Jest é…ç½®
â”œâ”€â”€ jest.setup.js              # Jest è®¾ç½®
â”œâ”€â”€ .prettierrc                # Prettier é…ç½®
â””â”€â”€ .prettierignore            # Prettier å¿½ç•¥æ–‡ä»¶
```

### ğŸ¯ å®ç°çš„åŠŸèƒ½ç‰¹æ€§

1. **å®Œæ•´çš„è®¤è¯æµç¨‹**
   - ç™»å½•ï¼ˆå¸¦è¡¨å•éªŒè¯ï¼‰
   - ç™»å‡º
   - Token å­˜å‚¨å’Œç®¡ç†
   - è‡ªåŠ¨ Token è¿‡æœŸæ£€æµ‹

2. **è·¯ç”±ä¿æŠ¤**
   - Middleware çº§åˆ«çš„è·¯ç”±ä¿æŠ¤
   - å®¢æˆ·ç«¯è®¤è¯å®ˆå«ç»„ä»¶
   - æœªè®¤è¯è‡ªåŠ¨é‡å®šå‘

3. **é”™è¯¯å¤„ç†**
   - ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
   - ç½‘ç»œé”™è¯¯å¤„ç†
   - API é”™è¯¯å¤„ç†
   - è®¤è¯é”™è¯¯å¤„ç†

4. **ç±»å‹å®‰å…¨**
   - å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
   - API å“åº”ç±»å‹
   - è®¤è¯ç›¸å…³ç±»å‹

### ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**ï¼šéœ€è¦åˆ›å»º `.env.local` æ–‡ä»¶è®¾ç½® `NEXT_PUBLIC_API_BASE_URL`
2. **Middleware è­¦å‘Š**ï¼šNext.js 16 ä¸­ middleware çš„å‘½åçº¦å®šå·²æ›´æ”¹ï¼Œä½†ä¸å½±å“åŠŸèƒ½
3. **æµ‹è¯•**ï¼šæµ‹è¯•æ¡†æ¶å·²è®¾ç½®ï¼Œä½†éƒ¨åˆ†æµ‹è¯•éœ€è¦è¿›ä¸€æ­¥è°ƒæ•´ mock è®¾ç½®
4. **Tailwind CSS**ï¼šå·²é…ç½® Tailwind CSS 4ï¼Œæ”¯æŒå“åº”å¼è®¾è®¡

### ğŸš€ ä¸‹ä¸€æ­¥

æ ¹æ® tasks.mdï¼Œä¸‹ä¸€æ­¥åº”è¯¥å®ç°ï¼š
- 3. æ ¸å¿ƒå¸ƒå±€ç»„ä»¶ï¼ˆä¾§è¾¹æ ã€é¡¶æ ã€é¢åŒ…å±‘ï¼‰
- 4. é€šç”¨ UI ç»„ä»¶ï¼ˆè¡¨æ ¼ã€å¡ç‰‡ã€å›¾è¡¨ç­‰ï¼‰
- 5. ä»ªè¡¨æ¿åŠŸèƒ½

